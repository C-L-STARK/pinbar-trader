<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="交易员心理测试 - 评估您的交易心理素质" />
    <title>交易员心理测试 - 源计划</title>
    <style>
      /* ===== CSS变量 ===== */
      :root {
        --primary-color: #6366f1;
        --primary-dark: #4f46e5;
        --primary-light: #818cf8;
        --secondary-color: #10b981;
        --accent-color: #f59e0b;
        --danger-color: #ef4444;

        --text-primary: #1f2937;
        --text-secondary: #6b7280;
        --text-light: #9ca3af;
        --text-white: #ffffff;

        --bg-primary: #ffffff;
        --bg-secondary: #f9fafb;
        --bg-tertiary: #f3f4f6;
        --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

        --border-color: #e5e7eb;
        --border-radius: 0.5rem;
        --border-radius-lg: 1rem;

        --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);

        --transition: 0.3s ease;
        --max-width: 900px;
      }

      /* ===== 基础重置 ===== */
      *,
      *::before,
      *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html {
        font-size: 16px;
        scroll-behavior: smooth;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, sans-serif;
        line-height: 1.6;
        color: var(--text-primary);
        background: var(--bg-secondary);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      button {
        font-family: inherit;
        cursor: pointer;
        border: none;
        outline: none;
      }

      ul {
        list-style: none;
      }

      a {
        text-decoration: none;
        color: inherit;
      }

      /* ===== 工具类 ===== */
      .container {
        max-width: var(--max-width);
        margin: 0 auto;
        padding: 0 1.5rem;
      }

      /* ===== 主内容区域 ===== */
      .main {
        flex: 1;
        padding: 3rem 0;
      }

      /* ===== 屏幕管理 ===== */
      .screen {
        display: none;
        animation: fadeIn 0.5s ease;
      }

      .screen.active {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* ===== 欢迎页面 ===== */
      .welcome-card {
        background: var(--bg-primary);
        border-radius: var(--border-radius-lg);
        padding: 3rem;
        box-shadow: var(--shadow-lg);
        text-align: center;
        max-width: 700px;
        margin: 0 auto;
      }

      .icon-wrapper {
        display: inline-flex;
        padding: 1.5rem;
        background: linear-gradient(
          135deg,
          var(--primary-color),
          var(--primary-light)
        );
        border-radius: 50%;
        margin-bottom: 2rem;
      }

      .icon-brain {
        width: 60px;
        height: 60px;
        stroke: white;
      }

      .welcome-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        color: var(--text-primary);
      }

      .welcome-subtitle {
        font-size: 1.25rem;
        color: var(--text-secondary);
        margin-bottom: 2.5rem;
      }

      .test-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2.5rem;
      }

      .info-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem;
        background: var(--bg-secondary);
        border-radius: var(--border-radius);
      }

      .info-icon {
        font-size: 2rem;
      }

      .info-content h3 {
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--text-secondary);
        margin-bottom: 0.25rem;
      }

      .info-content p {
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-primary);
      }

      .test-dimensions {
        background: var(--bg-secondary);
        border-radius: var(--border-radius);
        padding: 1.5rem;
        margin-bottom: 2rem;
        text-align: left;
      }

      .test-dimensions h3 {
        font-size: 1.125rem;
        margin-bottom: 1rem;
        color: var(--text-primary);
      }

      .test-dimensions ul {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 0.75rem;
      }

      .test-dimensions li {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1rem;
        color: var(--text-secondary);
      }

      .dimension-icon {
        font-size: 1.25rem;
      }

      .disclaimer {
        margin-top: 1.5rem;
        font-size: 0.875rem;
        color: var(--text-light);
        font-style: italic;
      }

      /* ===== 按钮样式 ===== */
      .btn-primary,
      .btn-secondary {
        padding: 0.875rem 2rem;
        border-radius: var(--border-radius);
        font-size: 1rem;
        font-weight: 600;
        transition: all var(--transition);
        display: inline-block;
      }

      .btn-primary {
        background: var(--primary-color);
        color: white;
      }

      .btn-primary:hover:not(:disabled) {
        background: var(--primary-dark);
        transform: translateY(-2px);
        box-shadow: var(--shadow-lg);
      }

      .btn-primary:disabled {
        background: var(--text-light);
        cursor: not-allowed;
      }

      .btn-secondary {
        background: transparent;
        color: var(--text-secondary);
        border: 2px solid var(--border-color);
      }

      .btn-secondary:hover:not(:disabled) {
        background: var(--bg-tertiary);
        border-color: var(--text-secondary);
      }

      .btn-large {
        padding: 1rem 3rem;
        font-size: 1.125rem;
      }

      /* ===== 测试页面 ===== */
      .test-container {
        max-width: 800px;
        margin: 0 auto;
      }

      .progress-wrapper {
        background: var(--bg-primary);
        padding: 1.5rem;
        border-radius: var(--border-radius-lg);
        margin-bottom: 2rem;
        box-shadow: var(--shadow-md);
      }

      .progress-info {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.75rem;
        font-size: 0.875rem;
        font-weight: 600;
        color: var(--text-secondary);
      }

      .progress-percent {
        color: var(--primary-color);
      }

      .progress-bar {
        height: 8px;
        background: var(--bg-tertiary);
        border-radius: 999px;
        overflow: hidden;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--primary-light)
        );
        border-radius: 999px;
        transition: width 0.5s ease;
        width: 0%;
      }

      .question-card {
        background: var(--bg-primary);
        padding: 2.5rem;
        border-radius: var(--border-radius-lg);
        box-shadow: var(--shadow-lg);
        margin-bottom: 2rem;
        min-height: 400px;
      }

      .question-category {
        display: inline-block;
        padding: 0.5rem 1rem;
        background: rgba(99, 102, 241, 0.1);
        color: var(--primary-color);
        border-radius: var(--border-radius);
        font-size: 0.875rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
      }

      .question-text {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 2rem;
        line-height: 1.4;
        color: var(--text-primary);
      }

      .options-container {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .option-btn {
        width: 100%;
        padding: 1.25rem 1.5rem;
        background: var(--bg-secondary);
        border: 2px solid var(--border-color);
        border-radius: var(--border-radius);
        text-align: left;
        font-size: 1rem;
        color: var(--text-primary);
        transition: all var(--transition);
        cursor: pointer;
      }

      .option-btn:hover {
        background: var(--bg-tertiary);
        border-color: var(--primary-light);
        transform: translateX(8px);
      }

      .option-btn.selected {
        background: rgba(99, 102, 241, 0.1);
        border-color: var(--primary-color);
        color: var(--primary-color);
        font-weight: 600;
      }

      /* ===== 结果页面 ===== */
      .result-container {
        max-width: 900px;
        margin: 0 auto;
      }

      .result-header {
        text-align: center;
        margin-bottom: 3rem;
      }

      .result-icon {
        font-size: 4rem;
        margin-bottom: 1rem;
      }

      .result-title {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      .result-subtitle {
        font-size: 1.25rem;
        color: var(--text-secondary);
      }

      .overall-score {
        background: var(--bg-primary);
        border-radius: var(--border-radius-lg);
        padding: 2.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow-lg);
        display: flex;
        align-items: center;
        gap: 3rem;
      }

      .score-circle {
        position: relative;
        width: 200px;
        height: 200px;
        flex-shrink: 0;
      }

      .score-svg {
        width: 100%;
        height: 100%;
        transform: rotate(-90deg);
      }

      .score-bg {
        fill: none;
        stroke: var(--bg-tertiary);
        stroke-width: 12;
      }

      .score-progress {
        fill: none;
        stroke: url(#scoreGradient);
        stroke-width: 12;
        stroke-linecap: round;
        stroke-dasharray: 565.48;
        stroke-dashoffset: 565.48;
        transition: stroke-dashoffset 1.5s ease;
      }

      .score-content {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        text-align: center;
      }

      .score-number {
        font-size: 3rem;
        font-weight: 700;
        color: var(--primary-color);
        line-height: 1;
      }

      .score-label {
        font-size: 0.875rem;
        color: var(--text-secondary);
        margin-top: 0.5rem;
      }

      .score-description {
        flex: 1;
      }

      .score-description h3 {
        font-size: 1.75rem;
        margin-bottom: 1rem;
        color: var(--text-primary);
      }

      .score-description p {
        font-size: 1.125rem;
        color: var(--text-secondary);
        line-height: 1.6;
      }

      .section-title {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 1.5rem;
        color: var(--text-primary);
      }

      .dimensions-score {
        background: var(--bg-primary);
        border-radius: var(--border-radius-lg);
        padding: 2.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow-md);
      }

      .dimension-bars {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }

      .dimension-bar {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
      }

      .dimension-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .dimension-name {
        font-weight: 600;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .dimension-score {
        font-weight: 700;
        color: var(--primary-color);
      }

      .dimension-bar-bg {
        height: 12px;
        background: var(--bg-tertiary);
        border-radius: 999px;
        overflow: hidden;
      }

      .dimension-bar-fill {
        height: 100%;
        background: linear-gradient(
          90deg,
          var(--primary-color),
          var(--primary-light)
        );
        border-radius: 999px;
        transition: width 1s ease;
        width: 0%;
      }

      .detailed-analysis {
        background: var(--bg-primary);
        border-radius: var(--border-radius-lg);
        padding: 2.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow-md);
      }

      .analysis-content {
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
      }

      .analysis-item {
        padding: 1.5rem;
        background: var(--bg-secondary);
        border-radius: var(--border-radius);
        border-left: 4px solid var(--primary-color);
      }

      .analysis-item h4 {
        font-size: 1.125rem;
        margin-bottom: 0.5rem;
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .analysis-item p {
        color: var(--text-secondary);
        line-height: 1.6;
      }

      .recommendations {
        background: var(--bg-primary);
        border-radius: var(--border-radius-lg);
        padding: 2.5rem;
        margin-bottom: 2rem;
        box-shadow: var(--shadow-md);
      }

      .recommendation-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .recommendation-item {
        display: flex;
        gap: 1rem;
        padding: 1.25rem;
        background: var(--bg-secondary);
        border-radius: var(--border-radius);
      }

      .recommendation-icon {
        flex-shrink: 0;
        width: 40px;
        height: 40px;
        background: rgba(99, 102, 241, 0.1);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
      }

      .recommendation-content {
        flex: 1;
      }

      .recommendation-content h4 {
        font-size: 1rem;
        margin-bottom: 0.25rem;
        color: var(--text-primary);
      }

      .recommendation-content p {
        font-size: 0.875rem;
        color: var(--text-secondary);
        line-height: 1.5;
      }

      .result-actions {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 2rem;
      }

      /* ===== 响应式设计 ===== */
      @media (max-width: 768px) {
        .welcome-card {
          padding: 2rem 1.5rem;
        }

        .welcome-title {
          font-size: 2rem;
        }

        .test-info {
          grid-template-columns: 1fr;
        }

        .test-dimensions ul {
          grid-template-columns: 1fr;
        }

        .question-card {
          padding: 1.5rem;
          min-height: auto;
        }

        .question-text {
          font-size: 1.25rem;
        }

        .overall-score {
          flex-direction: column;
          text-align: center;
          gap: 2rem;
        }

        .result-title {
          font-size: 2rem;
        }

        .result-actions {
          flex-direction: column;
        }

        .result-actions button {
          width: 100%;
        }
      }

      /* ===== SVG渐变定义 ===== */
      svg defs {
        display: none;
      }
    </style>
  </head>
  <body>
    <!-- 主要内容 -->
    <main class="main">
      <div class="container">
        <!-- 欢迎页面 -->
        <section id="welcomeScreen" class="screen active">
          <div class="welcome-card">
            <div class="icon-wrapper">
              <svg
                class="icon-brain"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"
                />
                <path
                  d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"
                />
              </svg>
            </div>
            <h2 class="welcome-title">交易员心理测试</h2>
            <p class="welcome-subtitle">全面评估您的交易心理素质</p>

            <div class="test-info">
              <div class="info-item">
                <div class="info-icon">📊</div>
                <div class="info-content">
                  <h3>测试时长</h3>
                  <p>约 5-8 分钟</p>
                </div>
              </div>
              <div class="info-item">
                <div class="info-icon">❓</div>
                <div class="info-content">
                  <h3>题目数量</h3>
                  <p>20 道题目</p>
                </div>
              </div>
              <div class="info-item">
                <div class="info-icon">🎯</div>
                <div class="info-content">
                  <h3>评估维度</h3>
                  <p>5 个核心维度</p>
                </div>
              </div>
            </div>

            <div class="test-dimensions">
              <h3>测试维度包括：</h3>
              <ul>
                <li><span class="dimension-icon">🎲</span> 风险承受能力</li>
                <li><span class="dimension-icon">😌</span> 情绪控制能力</li>
                <li><span class="dimension-icon">🧠</span> 决策能力</li>
                <li><span class="dimension-icon">📋</span> 纪律性</li>
                <li><span class="dimension-icon">💪</span> 压力管理</li>
              </ul>
            </div>

            <button class="btn-primary btn-large" id="startBtn">
              开始测试
            </button>

            <p class="disclaimer">请根据您的真实感受作答，没有对错之分</p>
          </div>
        </section>

        <!-- 测试页面 -->
        <section id="testScreen" class="screen">
          <div class="test-container">
            <!-- 进度条 -->
            <div class="progress-wrapper">
              <div class="progress-info">
                <span class="progress-text"
                  >问题 <span id="currentQuestion">1</span> /
                  <span id="totalQuestions">20</span></span
                >
                <span class="progress-percent" id="progressPercent">5%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
              </div>
            </div>

            <!-- 问题卡片 -->
            <div class="question-card" id="questionCard">
              <div class="question-category" id="questionCategory"></div>
              <h2 class="question-text" id="questionText"></h2>

              <div class="options-container" id="optionsContainer">
                <!-- 选项将通过JS动态生成 -->
              </div>
            </div>
          </div>
        </section>

        <!-- 结果页面 -->
        <section id="resultScreen" class="screen">
          <div class="result-container">
            <div class="result-header">
              <div class="result-icon">✨</div>
              <h2 class="result-title">测试完成</h2>
              <p class="result-subtitle">您的交易心理素质评估报告</p>
            </div>

            <!-- 总体评分 -->
            <div class="overall-score">
              <div class="score-circle">
                <svg class="score-svg" viewBox="0 0 200 200">
                  <circle class="score-bg" cx="100" cy="100" r="90"></circle>
                  <circle
                    class="score-progress"
                    cx="100"
                    cy="100"
                    r="90"
                    id="scoreCircle"
                  ></circle>
                </svg>
                <div class="score-content">
                  <div class="score-number" id="totalScore">0</div>
                  <div class="score-label">综合得分</div>
                </div>
              </div>
              <div class="score-description">
                <h3 id="scoreLevel"></h3>
                <p id="scoreText"></p>
              </div>
            </div>

            <!-- 各维度得分 -->
            <div class="dimensions-score">
              <h3 class="section-title">各维度得分</h3>
              <div class="dimension-bars" id="dimensionBars">
                <!-- 维度评分将通过JS动态生成 -->
              </div>
            </div>

            <!-- 详细分析 -->
            <div class="detailed-analysis">
              <h3 class="section-title">详细分析</h3>
              <div class="analysis-content" id="analysisContent">
                <!-- 分析内容将通过JS动态生成 -->
              </div>
            </div>

            <!-- 建议 -->
            <div class="recommendations">
              <h3 class="section-title">改进建议</h3>
              <div class="recommendation-list" id="recommendationList">
                <!-- 建议将通过JS动态生成 -->
              </div>
            </div>

            <!-- 操作按钮 -->
            <div class="result-actions">
              <button class="btn-primary" id="retakeBtn">重新测试</button>
            </div>
          </div>
        </section>
      </div>
    </main>

    <script>
      // ===== 测试题目数据 =====
      const questions = [
        // 风险承受能力 (4题)
        {
          id: 1,
          category: "风险承受能力",
          dimension: "risk",
          text: "当您的交易账户在一天内亏损10%时，您会如何反应？",
          options: [
            { text: "立即平仓，停止交易", score: 1 },
            { text: "感到焦虑，但继续观察", score: 2 },
            { text: "保持冷静，分析原因", score: 3 },
            { text: "认为这是正常波动，继续执行策略", score: 4 },
          ],
        },
        {
          id: 2,
          category: "风险承受能力",
          dimension: "risk",
          text: "在制定交易计划时，您通常会设定多大的单笔风险敞口？",
          options: [
            { text: "不超过账户的1%", score: 2 },
            { text: "账户的1-2%", score: 4 },
            { text: "账户的2-5%", score: 3 },
            { text: "没有固定标准，根据感觉来", score: 1 },
          ],
        },
        {
          id: 3,
          category: "风险承受能力",
          dimension: "risk",
          text: "您更倾向于哪种交易方式？",
          options: [
            { text: "保守稳健，追求小额稳定收益", score: 2 },
            { text: "平衡风险收益，适度激进", score: 4 },
            { text: "高风险高收益，追求大幅盈利", score: 2 },
            { text: "完全看市场机会决定", score: 1 },
          ],
        },
        {
          id: 4,
          category: "风险承受能力",
          dimension: "risk",
          text: '当看到一个"确定性很高"的交易机会时，您会投入多少仓位？',
          options: [
            { text: "10-20%的仓位", score: 4 },
            { text: "20-40%的仓位", score: 3 },
            { text: "40-60%的仓位", score: 2 },
            { text: "全仓或者加杠杆", score: 1 },
          ],
        },

        // 情绪控制能力 (4题)
        {
          id: 5,
          category: "情绪控制能力",
          dimension: "emotion",
          text: "当连续出现3次亏损交易后，您的心态会是？",
          options: [
            { text: "非常沮丧，怀疑自己的能力", score: 1 },
            { text: "有些失落，但告诉自己要坚持", score: 2 },
            { text: "保持平静，回顾交易寻找问题", score: 4 },
            { text: "完全不受影响，这是交易的一部分", score: 3 },
          ],
        },
        {
          id: 6,
          category: "情绪控制能力",
          dimension: "emotion",
          text: "盈利时，您会有怎样的情绪反应？",
          options: [
            { text: "兴奋激动，想要加大仓位", score: 1 },
            { text: "高兴，但会提醒自己保持理性", score: 3 },
            { text: "平静记录，继续执行计划", score: 4 },
            { text: "担心盈利回吐，想要立即止盈", score: 2 },
          ],
        },
        {
          id: 7,
          category: "情绪控制能力",
          dimension: "emotion",
          text: "在重要的经济数据发布前，您的状态通常是？",
          options: [
            { text: "紧张焦虑，难以集中注意力", score: 1 },
            { text: "有些紧张，但能控制", score: 2 },
            { text: "保持警觉，但情绪稳定", score: 4 },
            { text: "完全放松，按计划行事", score: 3 },
          ],
        },
        {
          id: 8,
          category: "情绪控制能力",
          dimension: "emotion",
          text: "当市场走势与您的预判完全相反时？",
          options: [
            { text: '固执己见，等待市场"回头"', score: 1 },
            { text: "情绪波动，但会考虑止损", score: 2 },
            { text: "立即止损，重新分析", score: 4 },
            { text: "保持冷静，检查止损位", score: 3 },
          ],
        },

        // 决策能力 (4题)
        {
          id: 9,
          category: "决策能力",
          dimension: "decision",
          text: "您在进行交易决策时主要依据什么？",
          options: [
            { text: "直觉和感觉", score: 1 },
            { text: "技术指标和图表", score: 3 },
            { text: "基本面分析", score: 3 },
            { text: "综合分析和交易系统", score: 4 },
          ],
        },
        {
          id: 10,
          category: "决策能力",
          dimension: "decision",
          text: "面对突发市场事件，您通常会？",
          options: [
            { text: "立即跟随市场情绪操作", score: 1 },
            { text: "先观望，再做决定", score: 3 },
            { text: "按照预案执行", score: 4 },
            { text: "暂停交易，等待明朗", score: 2 },
          ],
        },
        {
          id: 11,
          category: "决策能力",
          dimension: "decision",
          text: "您制定交易计划的频率是？",
          options: [
            { text: "没有固定计划，随机应变", score: 1 },
            { text: "偶尔做计划", score: 2 },
            { text: "每周制定计划", score: 3 },
            { text: "每次交易前都有详细计划", score: 4 },
          ],
        },
        {
          id: 12,
          category: "决策能力",
          dimension: "decision",
          text: "在决策时间紧迫的情况下，您的表现如何？",
          options: [
            { text: "容易慌乱，做出冲动决定", score: 1 },
            { text: "有些紧张，但能做决定", score: 2 },
            { text: "保持冷静，快速分析", score: 4 },
            { text: "宁愿错过，也不冲动", score: 3 },
          ],
        },

        // 纪律性 (4题)
        {
          id: 13,
          category: "纪律性",
          dimension: "discipline",
          text: "您设置止损后，执行情况如何？",
          options: [
            { text: "经常移动或取消止损", score: 1 },
            { text: "有时会调整止损", score: 2 },
            { text: "基本严格执行", score: 3 },
            { text: "始终严格执行", score: 4 },
          ],
        },
        {
          id: 14,
          category: "纪律性",
          dimension: "discipline",
          text: "关于交易日志，您的习惯是？",
          options: [
            { text: "从不记录", score: 1 },
            { text: "偶尔记录重要交易", score: 2 },
            { text: "经常记录", score: 3 },
            { text: "每笔交易都详细记录", score: 4 },
          ],
        },
        {
          id: 15,
          category: "纪律性",
          dimension: "discipline",
          text: "当达到预定的盈利目标后，您会？",
          options: [
            { text: "继续交易，想赚更多", score: 1 },
            { text: "视情况而定", score: 2 },
            { text: "通常会停止交易", score: 3 },
            { text: "严格执行，立即停止", score: 4 },
          ],
        },
        {
          id: 16,
          category: "纪律性",
          dimension: "discipline",
          text: "您是否会在情绪化的状态下进行交易？",
          options: [
            { text: "经常会", score: 1 },
            { text: "有时会", score: 2 },
            { text: "很少会", score: 3 },
            { text: "从不会", score: 4 },
          ],
        },

        // 压力管理 (4题)
        {
          id: 17,
          category: "压力管理",
          dimension: "stress",
          text: "在高强度交易期间，您的睡眠质量如何？",
          options: [
            { text: "严重失眠，无法休息", score: 1 },
            { text: "睡眠质量下降", score: 2 },
            { text: "稍有影响，但基本正常", score: 3 },
            { text: "完全不受影响", score: 4 },
          ],
        },
        {
          id: 18,
          category: "压力管理",
          dimension: "stress",
          text: "当面临重大交易决策的压力时，您会？",
          options: [
            { text: "感到巨大压力，影响判断", score: 1 },
            { text: "有压力，但能够应对", score: 2 },
            { text: "压力适中，反而更专注", score: 4 },
            { text: "没有压力，平常心对待", score: 3 },
          ],
        },
        {
          id: 19,
          category: "压力管理",
          dimension: "stress",
          text: "交易之外，您如何缓解压力？",
          options: [
            { text: "没有固定的方式", score: 1 },
            { text: "偶尔做些放松活动", score: 2 },
            { text: "定期运动或冥想", score: 4 },
            { text: "有完整的压力管理计划", score: 3 },
          ],
        },
        {
          id: 20,
          category: "压力管理",
          dimension: "stress",
          text: "长期交易对您的生活影响如何？",
          options: [
            { text: "严重影响生活和人际关系", score: 1 },
            { text: "有一定影响", score: 2 },
            { text: "影响较小，能平衡", score: 3 },
            { text: "完全平衡，互不干扰", score: 4 },
          ],
        },
      ];

      // ===== 维度配置 =====
      const dimensions = {
        risk: { name: "风险承受能力", icon: "🎲", color: "#6366f1" },
        emotion: { name: "情绪控制能力", icon: "😌", color: "#10b981" },
        decision: { name: "决策能力", icon: "🧠", color: "#f59e0b" },
        discipline: { name: "纪律性", icon: "📋", color: "#8b5cf6" },
        stress: { name: "压力管理", icon: "💪", color: "#ec4899" },
      };

      // ===== 应用状态 =====
      let currentQuestionIndex = 0;
      let answers = [];
      let testStartTime = null;

      // ===== DOM元素 =====
      const screens = {
        welcome: document.getElementById("welcomeScreen"),
        test: document.getElementById("testScreen"),
        result: document.getElementById("resultScreen"),
      };

      const elements = {
        startBtn: document.getElementById("startBtn"),
        retakeBtn: document.getElementById("retakeBtn"),

        currentQuestion: document.getElementById("currentQuestion"),
        totalQuestions: document.getElementById("totalQuestions"),
        progressPercent: document.getElementById("progressPercent"),
        progressFill: document.getElementById("progressFill"),

        questionCategory: document.getElementById("questionCategory"),
        questionText: document.getElementById("questionText"),
        optionsContainer: document.getElementById("optionsContainer"),

        totalScore: document.getElementById("totalScore"),
        scoreLevel: document.getElementById("scoreLevel"),
        scoreText: document.getElementById("scoreText"),
        scoreCircle: document.getElementById("scoreCircle"),
        dimensionBars: document.getElementById("dimensionBars"),
        analysisContent: document.getElementById("analysisContent"),
        recommendationList: document.getElementById("recommendationList"),
      };

      // ===== 屏幕切换 =====
      function showScreen(screenName) {
        Object.values(screens).forEach((screen) =>
          screen.classList.remove("active")
        );
        screens[screenName].classList.add("active");
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      // ===== 开始测试 =====
      function startTest() {
        currentQuestionIndex = 0;
        answers = new Array(questions.length).fill(null);
        testStartTime = Date.now();

        elements.totalQuestions.textContent = questions.length;
        showScreen("test");
        renderQuestion();
      }

      // ===== 渲染问题 =====
      function renderQuestion() {
        const question = questions[currentQuestionIndex];

        // 更新进度
        const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
        elements.currentQuestion.textContent = currentQuestionIndex + 1;
        elements.progressPercent.textContent = Math.round(progress) + "%";
        elements.progressFill.style.width = progress + "%";

        // 更新问题内容
        elements.questionCategory.textContent = question.category;
        elements.questionText.textContent = question.text;

        // 渲染选项
        elements.optionsContainer.innerHTML = "";
        question.options.forEach((option, index) => {
          const button = document.createElement("button");
          button.className = "option-btn";
          button.textContent = option.text;

          // 如果已经选择过，显示选中状态
          if (answers[currentQuestionIndex] === index) {
            button.classList.add("selected");
          }

          button.addEventListener("click", () => selectOption(index));
          elements.optionsContainer.appendChild(button);
        });
      }

      // ===== 选择选项 =====
      function selectOption(optionIndex) {
        answers[currentQuestionIndex] = optionIndex;

        // 更新UI
        const buttons =
          elements.optionsContainer.querySelectorAll(".option-btn");
        buttons.forEach((btn, idx) => {
          btn.classList.toggle("selected", idx === optionIndex);
        });

        // 自动跳转到下一题或显示结果
        setTimeout(() => {
          if (currentQuestionIndex < questions.length - 1) {
            currentQuestionIndex++;
            renderQuestion();
          } else {
            // 最后一题，显示结果
            showResults();
          }
        }, 300); // 延迟300ms让用户看到选中效果
      }

      // ===== 计算得分 =====
      function calculateScores() {
        const scores = {
          total: 0,
          dimensions: {
            risk: { score: 0, count: 0 },
            emotion: { score: 0, count: 0 },
            decision: { score: 0, count: 0 },
            discipline: { score: 0, count: 0 },
            stress: { score: 0, count: 0 },
          },
        };

        answers.forEach((answerIndex, questionIndex) => {
          const question = questions[questionIndex];
          const score = question.options[answerIndex].score;

          scores.total += score;
          scores.dimensions[question.dimension].score += score;
          scores.dimensions[question.dimension].count++;
        });

        // 计算百分比得分
        const maxScore = questions.length * 4;
        scores.percentage = Math.round((scores.total / maxScore) * 100);

        // 计算各维度平均分
        Object.keys(scores.dimensions).forEach((dim) => {
          const dimData = scores.dimensions[dim];
          dimData.average =
            dimData.count > 0 ? dimData.score / dimData.count : 0;
          dimData.percentage = Math.round((dimData.average / 4) * 100);
        });

        return scores;
      }

      // ===== 获取等级评价 =====
      function getScoreLevel(percentage) {
        if (percentage >= 85) {
          return {
            level: "优秀交易员",
            description:
              "您展现出了出色的交易心理素质。在风险控制、情绪管理、决策能力等方面都表现优异。继续保持这种专业的交易态度，您很可能成为一名成功的交易员。",
            color: "#10b981",
          };
        } else if (percentage >= 70) {
          return {
            level: "良好交易员",
            description:
              "您具备较好的交易心理素质，在多个维度上表现良好。通过持续学习和实践，关注弱项的改进，您有很大的提升空间。",
            color: "#6366f1",
          };
        } else if (percentage >= 55) {
          return {
            level: "合格交易员",
            description:
              "您具备基本的交易心理素质，但在某些方面还需要加强。建议重点关注得分较低的维度，通过学习和训练来提升。",
            color: "#f59e0b",
          };
        } else {
          return {
            level: "需要提升",
            description:
              "您的交易心理素质还有很大的提升空间。建议在进行实盘交易前，先系统学习交易心理学，并通过模拟交易来锻炼心理素质。",
            color: "#ef4444",
          };
        }
      }

      // ===== 显示结果 =====
      function showResults() {
        const scores = calculateScores();
        const levelInfo = getScoreLevel(scores.percentage);

        // 显示总分
        elements.totalScore.textContent = scores.percentage;
        elements.scoreLevel.textContent = levelInfo.level;
        elements.scoreText.textContent = levelInfo.description;

        // 动画显示圆形进度
        setTimeout(() => {
          const circumference = 2 * Math.PI * 90;
          const offset =
            circumference - (scores.percentage / 100) * circumference;
          elements.scoreCircle.style.strokeDashoffset = offset;
        }, 100);

        // 添加SVG渐变
        if (!document.querySelector("#scoreGradient")) {
          const svg = document.querySelector(".score-svg");
          const defs = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "defs"
          );
          const gradient = document.createElementNS(
            "http://www.w3.org/2000/svg",
            "linearGradient"
          );
          gradient.setAttribute("id", "scoreGradient");
          gradient.innerHTML = `
            <stop offset="0%" stop-color="#6366f1"/>
            <stop offset="100%" stop-color="#818cf8"/>
        `;
          defs.appendChild(gradient);
          svg.insertBefore(defs, svg.firstChild);
        }

        // 渲染维度得分
        renderDimensionScores(scores.dimensions);

        // 渲染分析
        renderAnalysis(scores.dimensions);

        // 渲染建议
        renderRecommendations(scores.dimensions);

        showScreen("result");
      }

      // ===== 渲染维度得分 =====
      function renderDimensionScores(dimensionsData) {
        elements.dimensionBars.innerHTML = "";

        Object.keys(dimensions).forEach((key, index) => {
          const dim = dimensions[key];
          const data = dimensionsData[key];

          const barElement = document.createElement("div");
          barElement.className = "dimension-bar";
          barElement.innerHTML = `
            <div class="dimension-header">
                <span class="dimension-name">
                    <span>${dim.icon}</span>
                    ${dim.name}
                </span>
                <span class="dimension-score">${data.percentage}分</span>
            </div>
            <div class="dimension-bar-bg">
                <div class="dimension-bar-fill" data-width="${data.percentage}"></div>
            </div>
        `;

          elements.dimensionBars.appendChild(barElement);

          // 动画显示进度条
          setTimeout(() => {
            const fill = barElement.querySelector(".dimension-bar-fill");
            fill.style.width = data.percentage + "%";
          }, 100 + index * 100);
        });
      }

      // ===== 渲染分析 =====
      function renderAnalysis(dimensionsData) {
        elements.analysisContent.innerHTML = "";

        const analyses = [];

        Object.keys(dimensions).forEach((key) => {
          const dim = dimensions[key];
          const data = dimensionsData[key];
          let text = "";

          if (data.percentage >= 80) {
            text = `您在${dim.name}方面表现优秀，能够很好地应对相关挑战。`;
          } else if (data.percentage >= 60) {
            text = `您在${dim.name}方面表现良好，但仍有提升空间。`;
          } else {
            text = `${dim.name}是您需要重点关注和提升的领域。`;
          }

          analyses.push({
            icon: dim.icon,
            name: dim.name,
            text: text,
            percentage: data.percentage,
          });
        });

        // 按得分排序，先显示需要改进的
        analyses.sort((a, b) => a.percentage - b.percentage);

        analyses.forEach((analysis) => {
          const item = document.createElement("div");
          item.className = "analysis-item";
          item.innerHTML = `
            <h4><span>${analysis.icon}</span> ${analysis.name}</h4>
            <p>${analysis.text}</p>
        `;
          elements.analysisContent.appendChild(item);
        });
      }

      // ===== 渲染建议 =====
      function renderRecommendations(dimensionsData) {
        elements.recommendationList.innerHTML = "";

        const recommendations = [
          {
            icon: "📚",
            title: "系统学习",
            text: "深入学习交易心理学和行为金融学，理解交易中的心理陷阱和认知偏差。",
          },
          {
            icon: "📝",
            title: "记录交易日志",
            text: "详细记录每笔交易的心理状态、决策过程和结果，定期回顾总结。",
          },
          {
            icon: "🎯",
            title: "模拟训练",
            text: "通过模拟交易来锻炼决策能力和情绪控制，在无风险环境中提升技能。",
          },
          {
            icon: "🧘",
            title: "冥想练习",
            text: "每天进行10-15分钟的冥想，提升专注力和情绪管理能力。",
          },
        ];

        // 根据得分较低的维度添加针对性建议
        Object.keys(dimensionsData).forEach((key) => {
          const data = dimensionsData[key];
          const dim = dimensions[key];

          if (data.percentage < 60) {
            let specificRec = null;

            switch (key) {
              case "risk":
                specificRec = {
                  icon: "⚠️",
                  title: "加强风险意识",
                  text: "学习和实践仓位管理，严格控制单笔交易风险，建立完善的风险管理体系。",
                };
                break;
              case "emotion":
                specificRec = {
                  icon: "💭",
                  title: "情绪管理训练",
                  text: "识别并记录交易中的情绪波动，学习情绪调节技巧，避免情绪化交易。",
                };
                break;
              case "decision":
                specificRec = {
                  icon: "🔍",
                  title: "提升分析能力",
                  text: "建立系统的分析框架，培养客观理性的决策习惯，避免主观臆断。",
                };
                break;
              case "discipline":
                specificRec = {
                  icon: "✅",
                  title: "严格执行纪律",
                  text: "制定明确的交易规则并严格遵守，培养交易纪律性，不随意更改计划。",
                };
                break;
              case "stress":
                specificRec = {
                  icon: "🏃",
                  title: "压力管理",
                  text: "建立健康的生活方式，定期运动放松，保持工作生活平衡。",
                };
                break;
            }

            if (specificRec) {
              recommendations.unshift(specificRec);
            }
          }
        });

        // 只显示前5个建议
        recommendations.slice(0, 5).forEach((rec) => {
          const item = document.createElement("div");
          item.className = "recommendation-item";
          item.innerHTML = `
            <div class="recommendation-icon">${rec.icon}</div>
            <div class="recommendation-content">
                <h4>${rec.title}</h4>
                <p>${rec.text}</p>
            </div>
        `;
          elements.recommendationList.appendChild(item);
        });
      }

      // ===== 重新测试 =====
      function retakeTest() {
        if (confirm("确定要重新开始测试吗？当前结果将会丢失。")) {
          startTest();
        }
      }

      // ===== 事件监听 =====
      elements.startBtn.addEventListener("click", startTest);
      elements.retakeBtn.addEventListener("click", retakeTest);

      // ===== 键盘快捷键 =====
      document.addEventListener("keydown", (e) => {
        if (screens.test.classList.contains("active")) {
          if (e.key >= "1" && e.key <= "4") {
            const optionIndex = parseInt(e.key) - 1;
            const question = questions[currentQuestionIndex];
            if (
              optionIndex < question.options.length &&
              answers[currentQuestionIndex] === null
            ) {
              selectOption(optionIndex);
            }
          }
        }
      });

      // ===== 初始化 =====
      console.log("交易员心理测试系统已加载");
      console.log(
        `共有 ${questions.length} 道题目，涵盖 ${
          Object.keys(dimensions).length
        } 个维度`
      );
    </script>
  </body>
</html>
